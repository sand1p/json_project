/**
This is a html file which contains javascript 
hich is used to parse json and retrieve relevant attributes.

*/
<HTML>
	<Head>
		<Title>Dummy creator</Title>
		<script type="text/javascript">
			op={};
			val="";	
			ignore=false;
			len=1;
			format=false;
			cardinality=false;
				 //loopcount=0;
				 function dummyCreator(){
				 	var data={"Show":{"CIM.Light.Data.Light":null},"DelResponseData":{"key":"Message.Value.Show.Result.LightDef.Action","Value":"all"}}
				 	var http = new XMLHttpRequest();
				 	var url = "http://localhost:8080/fid-CIMQueryInterface?SensorCustomerKey=CDP-All&AppKey=CDP-App&UserKey=CDP-User";
				 	var params = "SensorCustomerKey=CDP-All&AppKey=CDP-App&UserKey=CDP-User";
				 	http.open("POST", url, true);

					//Send the proper header information along with the request
					http.setRequestHeader("Content-type", "application/json");

					http.onreadystatechange = function(){//Call a function when the state changes.
						if(http.readyState == 4 && http.status == 200){
							http.responseText;
							var res =http.responseText;
							res=JSON.parse(res);
							iterate(res,"Show",op);

							console.log("output :"+JSON.stringify(output));
						}

					}
					http.send(JSON.stringify(data));
				} 
				
				function iterate(root,label,op){

					for (x in obj) {

						if(typeof(obj[x])=='object'){
							if(x=='Double' || x=='String' || x=='Boolean' || x=='DateTime' ||x=="Number"){
								 	
				        }

						//op[root[label][a]]=root[label][a]
					}


				}

			}


			case "Name" : 
			if(!ignore){
				if(cardinality){
									//console.log("cardinality ::" )
									output[obj[x]]=Array(len);  
							        //console.log() 				     		
							        cardinality=false;
							    }
							    else if(format){

							    	output[obj[x]]={ };
							    	format=false;
							    }
							    else{
							    	output[obj[x]]=obj[x];
							    }
							}
							else {
								ignore=false;
							}
							break;

							case "Cardinality" :


							if(typeof(obj[x])=='object'){
								len=obj[x].length;   

								if( obj[x][len-1][0] ==1){
									len=2 ;
								} 
								else if(obj[x][len-1][0] ==0){
									len=1; 
								}
							}
							else if(obj[x].length==1){
								len=1;
							}else if(obj[x][0]==1){
								len=2;
							}
							cardinality=true;
							break;

							case "Format":
							if(x=="Format" && obj[x].includes("ObjectFormat")){
								format=true;
							}
							else {
								format=false;
							}
							break;

							default :


							if(typeof(obj[x]) == 'object'){
								if(x=="Default" || x=="ReadOnly" || x=="Constant" || x=="Eq" ) { 
									ignore=true;  
									if(cardinality==true){
										cardinality=false;
									}                      	 
								}
								else {
									iterate(obj[x]);  
								}
							}

							else {
								if(x=="Default" || x=="ReadOnly" || x=="Constant" || x=="Eq" || x=="Transient") { 
									ignore=true;                             	 
									if(cardinality==true){
										cardinality=false;
									}
								}

							}	                                                          							   

							break;					   					 
						}

					}
				}
				dummyCreator();

			</script>
		</Head>
		<Body>
		</Body>
	</HTML>