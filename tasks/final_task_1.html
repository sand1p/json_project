<!DOCTYPE html>
<html>
<head>
	<title></title>
<script type="text/javascript">
	output={};
	function dummyCreator(){
				 	var data={"Show":{"CIM.Light.Data.Light":null},"DelResponseData":{"key":"Message.Value.Show.Result.LightDef.Action","Value":"all"}}
				 	var http = new XMLHttpRequest();
				 	var url = "http://localhost:8080/fid-CIMQueryInterface?SensorCustomerKey=CDP-All&AppKey=CDP-App&UserKey=CDP-User";
				 	var params = "SensorCustomerKey=CDP-All&AppKey=CDP-App&UserKey=CDP-User";
				 	http.open("POST", url, true);

					//Send the proper header information along with the request
					http.setRequestHeader("Content-type", "application/json");

					http.onreadystatechange = function(){//Call a function when the state changes.
						if(http.readyState == 4 && http.status == 200){
							http.responseText;
							var res =http.responseText;
							res=JSON.parse(res);
							iterate(res,"",output);
                            
							console.log("output :"+JSON.stringify(output));
						}

					}
					http.send(JSON.stringify(data));
				}
                
                function iterate(root,label,op){
                   
                      for(x in root){
                           if(typeof(root[x])=='object'){
                           	   op[x]={};
                           	   iterate(root[x],x,op[x])
                           } else {
                               op[x]=root[label];
                               
                           }


                      } 



                   console.log("loops through : ", root, "label : ",label,"output", op);
                   if(typeof(root[label])=='object'){
                        console.log("objects :",root[label])                    	
                        op[label]={};
                        console.log("op : ",op[label])
                        cur=root[label];


                        for(x in cur){
                            console.log("x in cur",x,"current :",cur)
                            iterate(cur,x,op[label]);

                        }
                    }   
                    else{
                    	console.log("non object attributes:",root[label])
                        op[label]=root[label];
                        console.log("in output:",op[label] )


                    }

                }
                dummyCreator();


</script>

</head>
<body>

</body>
</html>