	<!DOCTYPE html>
	<html>
	<head>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\script.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\JsonRestClient.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\Constants.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\CardinalityChecker.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\FormatSelector.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\DataGenerator.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\bodyCreator.js"> </script>
		<script type="text/javascript" src="C:\inetpub\wwwroot\cdp\json_task\NestedCreator.js"> </script>
		<title>Json Parser</title>

		<script type="text/javascript">
			modelName=getParameterByName("modelName",window.location.search);
			function iterate(root,label,op){
				 //if(ignorable.includesroot.)
				for(x in root){
					if(ignorable.includes(x)){
						cardinality=false;
						ignore=true;
						continue;
					}
					if(x == 'Cardinality' && root[x]!="" && !ignore){
						len1=cardinalityChecker(root,x);
					}
					else if(x =='Format') {
						objectFormat=formatSelector(root,x,objectFormat);
					}
					else if(dataTypes.includes(x)){
						dataValue=dataGenerator(x);
						val=x; 
						
						if(Array.isArray(root[x])){
							n=root[x].length;
							strObj={};
							if(cardinality){
								for(arrLen=0;arrLen<len1;arrLen++){
									strObj={};
									for(i=0;i<n;i++){	  
										if(dataValue!=''){
											strObj[root[val][i].Name]=dataValue;
										} else {
											strObj[root[val][i].Name]=root[val][i].Name;
										}
									}
									objArray[arrLen]=strObj;
								}
								op=objArray;
							}else {
								if(root[x].Name != undefined){
									parentTagName=root[x].Name;
									op[parentTagName]={};
									root[x].Name="";
									for(p=0;p<n;p++){	   
										iterate(root[val][p],label,op[parentTagName]);
									}	
								}else {
									for(q=0;q<n;q++){	   
										iterate(root[val][q],label,op);
									}
								}
							}	
						}
						else if(Object.isObject(root[x])){
							iterate(root[x],label,op);
						}
					}

					else if(x=='Name'){
						if(!ignore && root[x]!=""){
							if(cardinality){
								arr=Array(len)
								for(keys=0;keys<len;keys++){
									arr[keys]=root[x]+(keys+1);
								}  
								op[root[x]]=arr;
								cardinality=false;
							}else if(objectFormat){
								key=root[x];
								op[root[x]]={};
								objectFormat=false;
							}else if(nesting){
								op[root[x]]=nestedJson;
								nesting=false;
							}else if(root[x]!=modelName){ 
								if(val=='String'){
									op[root[x]]=root[x];
								}else {
									op[root[x]]=dataValue;
								}
							}
						}
						else{
							ignore=false;
							cardinality=false;
							objectFormat=false;
						}
					}
					else if(x=='sid'){
						op[x]='sid';

					}
					else if(Object.isObject(root[x])){
						if(root[x].Name!=undefined){
							parentTagName=root[x].Name;
                            root[x].Name=""; 
							if(root[x].Cardinality!=undefined){
								nesVal=x;
								rootTagName=parentTagName;
								len=cardinalityChecker(root,x);
								root[x].Cardinality="";
								cardinality=false;
								nestedCardinality=true;
                                 nesArray=Array(len);
                                 for(r=0;r<len;r++){
                                 	nesArray[r]={}
                                 }
                                 iterate(root[nesVal],parentTagName,nesArray[0]);
                                 if(len==2){
                                 	nesArray[1]=nesArray[0];
                                 }     
                                 console.log("nested Array :",JSON.stringify(nesArray));

                                 op[rootTagName]=nesArray; 
								nestedCardinality=false;
							} else {
						        op[parentTagName]={};
						     	iterate(root[x],parentTagName,op[parentTagName]);
						    }
						}
					}else if(Array.isArray(root[x])){
						m=root[x].length;
						valx=x;
						if(root[x].Name!=undefined){
							parentTagName=root[valx].Name;
							op[parentTagName]={};
							for(j=0;j<m;j++){
								console.log("array values : ",root[valx][j]);
							    root[x].Name=""; 
								iterate(root[valx][j],label,op[parentTagName]);
							}
						}
						else {
							for(j=0;j<m;j++){
								console.log("array values : ",root[valx][j]);
								if(root[valx][j].Name!=undefined){
									parentTagName=root[valx][j].Name;
									op[parentTagName]={};
									root[valx][j].Name="";
									iterate(root[valx][j],parentTagName,op[parentTagName]);
								}
								else {
									iterate(root[valx][j],label,op);
								}
							}
						}
					}

					else if(x=='Value'){
						nestedModelName=root[x];
						nestedJson=nestedCreator(nestedModelName);
						nesting =true;
					}
				}
			}	
			dummyCreator(modelName);
		</script>
	</head>
	<body>

		<div>   
		<textarea name="uiOutput" id="myTextArea" rows="100" cols="100"></textarea>
		</div>
	</body>
	</html>
